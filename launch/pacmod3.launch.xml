<?xml version="1.0"?>
<launch>
  <!-- See README for available vehicle types -->
  <arg name="pacmod_vehicle_type" default="LEXUS_RX_450H" />
  <arg name="use_kvaser" default="false" />
  <arg name="kvaser_hardware_id" default="12345" />
  <arg name="kvaser_circuit_id" default="0" />
  <arg name="use_socketcan" default="false" />
  <arg name="socketcan_device" default="can0" />
  <arg name="namespace" default="pacmod" />

  <group>
    <push-ros-namespace namespace="$(var namespace)" />

    <include if="$(var use_kvaser)" file="$(find-pkg-share kvaser_interface)/launch/kvaser_bridge.launch">
      <arg name="hardware_id" value="$(var kvaser_hardware_id)" />
      <arg name="circuit_id" value="$(var kvaser_circuit_id)" />
      <arg name="bit_rate" value="500000" />
    </include>

    <group if="$(var use_socketcan)">
      <!-- Unfortunately remaps only work within node tags, can't use include here -->
      <node pkg="ros2_socketcan" exec="socket_can_receiver_node_exe" name="socket_can_receiver">
        <param name="interface" value="$(var socketcan_device)" />
        <remap from="from_can_bus" to="can_tx" />
      </node>
      <node pkg="ros2_socketcan" exec="socket_can_sender_node_exe" name="socket_can_sender">
        <param name="interface" value="$(var socketcan_device)" />
        <remap from="to_can_bus" to="can_rx" />
      </node>
    </group>

    <node pkg="pacmod3" exec="pacmod3_driver" name="pacmod" output="screen">
      <param name="vehicle_type" value="$(var pacmod_vehicle_type)" />
    </node>
  </group>
</launch>
